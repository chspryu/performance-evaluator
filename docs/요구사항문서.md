# 연주 평가 프로그램 — 프로젝트 요구사항문서 (PRD)

**문서 버전:** 1.0  
**작성일:** 2026-02-16  
**프로젝트명:** 연주 평가기 (Performance Evaluator)

---

## 1. 개요

### 1.1 목적
사용자가 업로드한 **악보**, **참조용 프로 연주 영상(YouTube)**, **본인 연주 영상(YouTube 또는 로컬 파일)**을 입력받아, **Gemini**를 활용해 악보·참조 연주를 기준으로 본인 연주의 품질을 점수화하고, 마디별 차이와 개선점을 제시하는 **웹 기반 연주 평가 서비스**를 구축한다.

### 1.2 대상 사용자
- 악기 연주를 연습하고 실력을 점검하고 싶은 아마추어 연주자
- 프로 연주자의 연주를 벤치마크로 삼아 스스로를 평가하고 싶은 사용자
- PC 및 모바일 환경에서 접근 가능한 서비스를 원하는 사용자

### 1.3 핵심 가치
- **악보 기반 평가**: 악보와의 정확도·해석 일치도 반영
- **참조 연주 기반 비교**: 프로 연주와의 기술·표현 차이를 구체적으로 제시
- **사용자 Gemini 계정 연동**: 개발자가 API 키를 심지 않고, 사용자 본인 계정으로 Gemini를 사용

---

## 2. 기능 요구사항

### 2.1 입력 단계 (3단계 플로우)

| 단계 | 입력 항목 | 형식 | 필수 여부 | 비고 |
|------|-----------|------|-----------|------|
| 1 | 악보 | PDF, 이미지(PNG, JPG 등) 업로드 | 필수 | 다중 페이지 지원 권장 |
| 2 | 참조 연주(프로) | YouTube URL | 필수 | 공개/비공개 링크 처리 정책 정의 필요 |
| 3 | 본인 연주 | YouTube URL **또는** 로컬 동영상 파일 업로드 | 필수 | 파일 크기·형식 제한 정의 필요 |

- **악보**: 서버/클라이언트에서 Gemini가 이해할 수 있도록 이미지 또는 PDF 페이지별 이미지로 전달 가능하도록 설계
- **YouTube**: URL만 저장 후, 평가 시점에 영상 접근 가능 여부 확인 및 오디오/영상 추출 방식 결정 필요 (Gemini 비디오 API 사용 시 링크 전달 또는 미디어 파일 전달)
- **로컬 동영상**: 업로드 후 스토리지에 임시 저장. 평가 완료 후 **원본 동영상/악보 파일**은 삭제하고, **평가 결과는 이력으로 저장**하여 실력 향상 추이를 볼 수 있게 한다.

### 2.2 Gemini 연동 방식

- **사용자 Gemini 계정 사용**
  - 방식 후보:
    - **A)** 사용자가 **Gemini API 키**를 입력하여 본인 계정의 API 할당량 사용
    - **B)** **Google OAuth**로 로그인 후, 해당 계정에 연결된 Gemini/Vertex 등 사용 (구현 복잡도 높음)
  - 권장: 초기에는 **A) API 키 입력** 방식으로 구현하여, 사용자가 [Google AI Studio](https://aistudio.google.com/) 등에서 발급한 API 키를 앱에 입력해 사용
  - API 키는 **클라이언트가 아닌 백엔드에서만** 사용하고, 저장 시 암호화·세션/계정별 분리 저장 등 보안 정책 적용

### 2.3 평가 결과 요구사항

1. **총점**
   - **100점 만점**으로 종합 점수 제시
   - 소수점 또는 정수 여부는 구현 시 결정

2. **평가 관점**
   - **기술적 요소**: 음정, 리듬, 박자, 운지/주법, 음색 안정성 등
   - **음악적·표현적 요소**: 프레이징, 다이내믹스, 루바토, articulation, 전반적인 해석과 표현력

3. **세부 비교 (마디 단위)**
   - 악보·참조 연주와 본인 연주를 **마디(또는 구간)별로** 비교
   - 각 구간별로:
     - **차이점**: 프로 대비 무엇이 다른지(속도, 강약, articulation 등) 서술
     - **개선 제안**: 구체적인 연습 방향 또는 포인트

4. **출력 형태**
   - 텍스트 요약 + 필요 시 구간별 리스트(마디 번호/구간 + 설명)
   - PC·모바일에서 읽기 편한 반응형 UI로 표시

### 2.4 평가 이력 관리 (저장·목록·삭제)

- **저장**: 한 번 수행한 비교(평가) 결과를 바로 삭제하지 않고 **저장**한다. 사용자가 연습하면서 실력 향상 추이를 볼 수 있도록 한다.
- **이력 목록**: 저장된 평가 목록을 **날짜순(최신순)** 등으로 조회할 수 있다. 각 항목에는 평가 일시, 총점, 참조/본인 연주 요약(선택) 등이 노출된다.
- **이력 상세**: 목록에서 한 건을 선택하면 해당 평가의 **총점·요약·마디별 비교·개선 제안**을 다시 볼 수 있다.
- **새 비교 추가**: 언제든 **새로운 평가**를 진행할 수 있다(단계 1→2→3 플로우). 이력 화면에서도 "새 비교하기" 등으로 진입 가능.
- **기존 삭제**: 더 이상 필요 없는 이력은 **개별 삭제**할 수 있다. 삭제 시 해당 평가 결과만 제거한다.

### 2.5 비기능 요구사항

- **플랫폼**: PC 웹 브라우저 + 모바일 브라우저에서 동일하게 이용 가능 (반응형 웹)
- **보안**
  - 사용자 API 키는 서버에 저장 시 암호화, 전송 시 HTTPS
  - 업로드된 악보·영상은 평가 목적으로만 사용, 보관 기간 최소화
- **성능**
  - 대용량 동영상 업로드 시 진행률 표시
  - 평가 처리 시간이 길 수 있으므로 비동기 처리 + 완료 알림(이메일/알림 등은 선택)
- **접근성**
  - 키보드·스크린 리더 기본 지원 권장

---

## 3. 시스템 구성 (개략)

```
[사용자]
  ↓ 악보 업로드 / YouTube URL / 연주 영상(URL 또는 파일)
[웹 클라이언트 (PC·모바일 반응형)]
  ↓
[백엔드 서버]
  - 업로드 파일 수신·임시 저장
  - YouTube URL 검증 및 메타정보 확인
  - 사용자 제공 Gemini API 키로 Gemini API 호출
  - 악보(이미지), 참조 영상, 본인 연주 영상/오디오를 Gemini에 전달
  ↓
[Google Gemini API]
  - 멀티모달 입력(악보 이미지 + 영상/오디오) 처리
  - 평가·비교·마디별 분석 결과 텍스트 생성
  ↓
[백엔드 → 클라이언트]
  - 결과 저장(이력 DB) 및 화면에 표시
  - 이력 목록/상세/삭제 API 제공
```

- **YouTube 처리**:  
  - Gemini가 YouTube URL을 직접 받는지 확인 후, 가능하면 URL 전달, 불가 시 서버에서 오디오/영상 추출 후 파일로 전달하는 방식 선택

---

## 4. 화면/플로우 요구사항

1. **시작 화면**
   - 서비스 소개, 3단계 입력 플로우 안내
   - (선택) API 키 입력/저장 화면 또는 설정 메뉴

2. **단계 1: 악보 업로드**
   - 드래그 앤 드롭 또는 파일 선택
   - 지원 형식 표시 (PDF, PNG, JPG 등)
   - 업로드 후 미리보기 가능하면 좋음

3. **단계 2: 참조 연주(프로) YouTube 링크**
   - URL 입력 필드
   - 유효한 YouTube URL 검증 및 재생 가능 여부 안내

4. **단계 3: 본인 연주 입력**
   - 선택지: YouTube URL **또는** 로컬 동영상 업로드
   - URL 입력 시 검증, 파일 업로드 시 용량·형식 제한 안내 및 진행률 표시

5. **Gemini API 키 설정**
   - 최초 또는 설정에서 API 키 입력
   - “본인 Gemini 계정으로 사용” 안내 문구

6. **평가 실행**
   - “평가하기” 버튼 클릭 후 처리 중 표시(로딩)
   - 오류 시 재시도·오류 메시지 표시

7. **결과 화면**
   - 총점 (100점 만점)
   - 기술/표현 관점 요약
   - 마디(구간)별 차이점 및 개선 제안
   - PC·모바일에서 스크롤·가독성 확보
   - "이력에 저장됨" 안내 및 "이력 보기" 링크

8. **이력 목록 화면**
   - 저장된 평가 목록(날짜·총점·요약 등)
   - 새 비교 추가 버튼, 각 항목 클릭 시 상세 이동, 개별 삭제 버튼

9. **이력 상세 화면**
   - 선택한 평가의 결과 전체 재표시(결과 화면과 동일 레이아웃)
   - 삭제 버튼, 목록으로 돌아가기

---

## 5. 기술 스택 제안 (참고)

- **프론트엔드**: HTML5, CSS3(반응형), JavaScript (또는 React/Vue 등 SPA)
- **백엔드**: Node.js (Express 등) 또는 Python (FastAPI 등) — 파일 업로드, Gemini API 호출
- **Gemini**: Google Gemini API (멀티모달: 이미지 + 비디오/오디오)
- **스토리지**: 업로드 파일 임시 저장용 로컬/클라우드 스토리지; **평가 이력** 저장용 DB(또는 파일 기반)
- **YouTube**: URL 검증 및 필요 시 youtube-dl/yt-dlp 등으로 오디오 추출 후 Gemini에 전달 (이용 약관 확인 필요)

---

## 6. 제약 사항 및 고려 사항

- **YouTube 이용 약관**: 영상 다운로드·추출 시 YouTube ToS 및 저작권 준수 필요. 가능하면 “Gemini가 YouTube URL을 직접 처리하는지” 우선 확인.
- **Gemini 비디오 입력**: 입력 가능한 영상 길이·용량 제한 확인 필요.
- **악보 인식**: 악보 품질에 따라 인식 정확도가 달라질 수 있음을 사용자에게 안내.
- **다국어**: 초기 버전은 한국어 UI·한국어 평가 결과를 기준으로 설계.

---

## 7. 향후 확장 (선택)

- 이력 목록에서 점수 추이 차트(그래프) 표시
- 여러 참조 연주(다른 프로) 동시 비교
- 악기/장르별 프롬프트 템플릿 분리
- Google 로그인 후 API 키 대신 OAuth로 Gemini 연동

---

## 8. 문서 이력

| 버전 | 일자 | 변경 내용 |
|------|------|-----------|
| 1.0 | 2026-02-16 | 최초 작성 |
| 1.1 | 2026-02-16 | 평가 이력 관리(저장·목록·삭제·새 비교 추가) 반영 |

---

이 요구사항문서를 바탕으로 다음 단계에서 **와이어프레임**, **API 명세**, **기술 설계서** 등을 정리할 수 있습니다.
